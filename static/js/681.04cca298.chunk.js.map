{"version":3,"file":"static/js/681.04cca298.chunk.js","mappings":"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","sources":["pages/Profile.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport \"../styles/profile.css\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\nimport { setLoading } from \"../redux/reducers/rootSlice\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport Loading from \"../components/Loading\";\nimport fetchData from \"../helper/apiCall\";\nimport jwt_decode from \"jwt-decode\";\n\naxios.defaults.baseURL = process.env.REACT_APP_SERVER_DOMAIN;\n\nfunction Profile() {\n  const { userId } = jwt_decode(localStorage.getItem(\"token\"));\n  const dispatch = useDispatch();\n  const { loading } = useSelector((state) => state.root);\n  const navigate = useNavigate();\n\n  const [file, setFile] = useState(\"\");\n  const [formDetails, setFormDetails] = useState({\n    firstname: \"\",\n    lastname: \"\",\n    email: \"\",\n    age: \"\",\n    mobile: \"\",\n    gender: \"neither\",\n    address: \"\",\n    password: \"\",\n    confpassword: \"\",\n    assurance: \"none\",\n  });\n  const [initialDetails, setInitialDetails] = useState({});\n\n  const getUser = async () => {\n    try {\n      dispatch(setLoading(true));\n      const temp = await fetchData(`/user/getuser/${userId}`);\n      const details = {\n        ...temp,\n        password: \"\",\n        confpassword: \"\",\n        mobile: temp.mobile || \"\",\n        age: temp.age || \"\",\n        assurance: temp.assurance || \"none\",\n      };\n      setFormDetails(details);\n      setInitialDetails(details);\n      setFile(temp.pic);\n      dispatch(setLoading(false));\n    } catch {\n      dispatch(setLoading(false));\n    }\n  };\n\n  useEffect(() => {\n    getUser();\n  }, [dispatch]);\n\n  const inputChange = (e) => {\n    const { name, value } = e.target;\n    setFormDetails({ ...formDetails, [name]: value });\n  };\n\n  const handleBackHome = () => navigate(\"/\");\n\n  const formSubmit = async (e) => {\n    e.preventDefault();\n    const { firstname, lastname, email, age, mobile, address, gender, password, confpassword, assurance } = formDetails;\n\n    if (!email) return toast.error(\"Email cannot be empty\");\n    if (firstname.length < 3) return toast.error(\"First name must be at least 3 characters\");\n    if (lastname.length < 3) return toast.error(\"Last name must be at least 3 characters\");\n    if (password && password.length < 5) return toast.error(\"Password must be at least 5 characters\");\n    if (password !== confpassword) return toast.error(\"Passwords do not match\");\n\n    // Check if anything changed\n    const hasChanges =\n      firstname !== initialDetails.firstname ||\n      lastname !== initialDetails.lastname ||\n      email !== initialDetails.email ||\n      age !== initialDetails.age ||\n      mobile !== initialDetails.mobile ||\n      address !== initialDetails.address ||\n      gender !== initialDetails.gender ||\n      assurance !== initialDetails.assurance ||\n      (password && password.length > 0);\n\n    if (!hasChanges) return toast.error(\"No changes detected to update\");\n\n    try {\n      const updateData = { firstname, lastname, age, mobile, address, gender, email, assurance };\n      if (password) updateData.password = password;\n\n      const response = await toast.promise(\n        axios.put(\"/user/updateprofile\", updateData, {\n          headers: { authorization: `Bearer ${localStorage.getItem(\"token\")}` },\n        }),\n        { pending: \"Updating profile...\", success: \"Profile updated\", error: \"Update failed\" }\n      );\n\n      // Update frontend state with returned user\n      const updatedUser = response.data;\n      setFormDetails({ ...updatedUser, password: \"\", confpassword: \"\" });\n      setInitialDetails({ ...updatedUser, password: \"\", confpassword: \"\" });\n\n      toast.success(\"Profile and assurance updated successfully\");\n    } catch (err) {\n      toast.error(\"Unable to update profile\");\n    }\n  };\n\n  if (loading) return <Loading />;\n\n  return (\n    <section className=\"register-section flex-center\">\n      <div className=\"profile-container flex-center\">\n        <h2 className=\"form-heading\">Profile</h2>\n        <img src={file} alt=\"profile\" className=\"profile-pic\" />\n        <form onSubmit={formSubmit} className=\"register-form\">\n          <div className=\"form-same-row\">\n            <input type=\"text\" name=\"firstname\" className=\"form-input\" placeholder=\"First name\" value={formDetails.firstname} onChange={inputChange} />\n            <input type=\"text\" name=\"lastname\" className=\"form-input\" placeholder=\"Last name\" value={formDetails.lastname} onChange={inputChange} />\n          </div>\n          <div className=\"form-same-row\">\n            <input type=\"email\" name=\"email\" className=\"form-input\" placeholder=\"Email\" value={formDetails.email} onChange={inputChange} />\n            <select name=\"gender\" className=\"form-input\" value={formDetails.gender} onChange={inputChange}>\n              <option value=\"neither\">-</option>\n              <option value=\"male\">Male</option>\n              <option value=\"female\">Female</option>\n            </select>\n          </div>\n          <div className=\"form-same-row\">\n            <input type=\"text\" name=\"age\" className=\"form-input\" placeholder=\"Age\" value={formDetails.age} onChange={inputChange} />\n            <input type=\"text\" name=\"mobile\" className=\"form-input\" placeholder=\"Mobile\" value={formDetails.mobile} onChange={inputChange} />\n          </div>\n          <textarea name=\"address\" className=\"form-input\" placeholder=\"Address\" value={formDetails.address} onChange={inputChange} rows=\"1\" />\n          <div style={{ width: \"100%\", marginTop: \"1.5rem\", display: \"flex\", flexDirection: \"column\", gap: \"0.5rem\" }}>\n            <label htmlFor=\"assurance\" style={{ color: \"#112179ff\", fontWeight: 600, fontSize: \"1.05rem\" }}>Assurance Plan</label>\n            <select name=\"assurance\" value={formDetails.assurance} id=\"assurance\" onChange={inputChange} style={{ padding: \"0.8rem 1rem\", fontSize: \"1rem\", borderRadius: \"8px\", border: \"1px solid #ccc\", width: \"100%\", appearance: \"none\", backgroundColor: \"#fff\", cursor: \"pointer\" }}>\n              <option value=\"none\">None</option>\n              <option value=\"normal\">Normal (50% cover, 180 DH/month)</option>\n              <option value=\"premium\">Premium (100% cover, 365 DH/month)</option>\n            </select>\n          </div>\n          <div className=\"form-same-row\">\n            <input type=\"password\" name=\"password\" className=\"form-input\" placeholder=\"Password\" value={formDetails.password} onChange={inputChange} />\n            <input type=\"password\" name=\"confpassword\" className=\"form-input\" placeholder=\"Confirm Password\" value={formDetails.confpassword} onChange={inputChange} />\n          </div>\n          <button type=\"submit\" className=\"btn form-btn\">Update</button>\n        </form>\n        <button type=\"button\" className=\"btn form-btn\" style={{ marginTop: \"1rem\", backgroundColor: \"#112179ff\" }} onClick={handleBackHome}>Back to Home</button>\n      </div>\n    </section>\n  );\n}\n\nexport default Profile;\n"],"names":["axios","defaults","baseURL","process","userId","jwt_decode","localStorage","getItem","dispatch","useDispatch","loading","useSelector","state","root","navigate","useNavigate","file","setFile","useState","formDetails","setFormDetails","firstname","lastname","email","age","mobile","gender","address","password","confpassword","assurance","initialDetails","setInitialDetails","useEffect","async","setLoading","temp","fetchData","concat","details","_objectSpread","pic","_unused","getUser","inputChange","e","name","value","target","_jsx","Loading","className","children","_jsxs","src","alt","onSubmit","preventDefault","toast","error","length","updateData","updatedUser","promise","put","headers","authorization","pending","success","data","err","type","placeholder","onChange","rows","style","width","marginTop","display","flexDirection","gap","htmlFor","color","fontWeight","fontSize","id","padding","borderRadius","border","appearance","backgroundColor","cursor","onClick","handleBackHome"],"sourceRoot":""}