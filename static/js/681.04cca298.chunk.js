"use strict";(self.webpackChunkDDS_FRONT=self.webpackChunkDDS_FRONT||[]).push([[681],{681:(e,a,s)=>{s.r(a),s.d(a,{default:()=>f});var r=s(9379),n=s(5043),t=s(3216),o=s(9722),l=s(3768),i=s(5089),c=s(9456),m=s(8271),d=s(5789),p=s(7070),u=s(579);o.A.defaults.baseURL="https://dds-project-hospital-appointment-system.onrender.com/api";const f=function(){const{userId:e}=(0,p.A)(localStorage.getItem("token")),a=(0,c.wA)(),{loading:s}=(0,c.d4)(e=>e.root),f=(0,t.Zp)(),[h,g]=(0,n.useState)(""),[x,w]=(0,n.useState)({firstname:"",lastname:"",email:"",age:"",mobile:"",gender:"neither",address:"",password:"",confpassword:"",assurance:"none"}),[b,j]=(0,n.useState)({});(0,n.useEffect)(()=>{(async()=>{try{a((0,i.r1)(!0));const s=await(0,d.A)("/user/getuser/".concat(e)),n=(0,r.A)((0,r.A)({},s),{},{password:"",confpassword:"",mobile:s.mobile||"",age:s.age||"",assurance:s.assurance||"none"});w(n),j(n),g(s.pic),a((0,i.r1)(!1))}catch(s){a((0,i.r1)(!1))}})()},[a]);const y=e=>{const{name:a,value:s}=e.target;w((0,r.A)((0,r.A)({},x),{},{[a]:s}))};return s?(0,u.jsx)(m.A,{}):(0,u.jsx)("section",{className:"register-section flex-center",children:(0,u.jsxs)("div",{className:"profile-container flex-center",children:[(0,u.jsx)("h2",{className:"form-heading",children:"Profile"}),(0,u.jsx)("img",{src:h,alt:"profile",className:"profile-pic"}),(0,u.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const{firstname:a,lastname:s,email:n,age:t,mobile:i,address:c,gender:m,password:d,confpassword:p,assurance:u}=x;if(!n)return l.Ay.error("Email cannot be empty");if(a.length<3)return l.Ay.error("First name must be at least 3 characters");if(s.length<3)return l.Ay.error("Last name must be at least 3 characters");if(d&&d.length<5)return l.Ay.error("Password must be at least 5 characters");if(d!==p)return l.Ay.error("Passwords do not match");if(!(a!==b.firstname||s!==b.lastname||n!==b.email||t!==b.age||i!==b.mobile||c!==b.address||m!==b.gender||u!==b.assurance||d&&d.length>0))return l.Ay.error("No changes detected to update");try{const e={firstname:a,lastname:s,age:t,mobile:i,address:c,gender:m,email:n,assurance:u};d&&(e.password=d);const p=(await l.Ay.promise(o.A.put("/user/updateprofile",e,{headers:{authorization:"Bearer ".concat(localStorage.getItem("token"))}}),{pending:"Updating profile...",success:"Profile updated",error:"Update failed"})).data;w((0,r.A)((0,r.A)({},p),{},{password:"",confpassword:""})),j((0,r.A)((0,r.A)({},p),{},{password:"",confpassword:""})),l.Ay.success("Profile and assurance updated successfully")}catch(f){l.Ay.error("Unable to update profile")}},className:"register-form",children:[(0,u.jsxs)("div",{className:"form-same-row",children:[(0,u.jsx)("input",{type:"text",name:"firstname",className:"form-input",placeholder:"First name",value:x.firstname,onChange:y}),(0,u.jsx)("input",{type:"text",name:"lastname",className:"form-input",placeholder:"Last name",value:x.lastname,onChange:y})]}),(0,u.jsxs)("div",{className:"form-same-row",children:[(0,u.jsx)("input",{type:"email",name:"email",className:"form-input",placeholder:"Email",value:x.email,onChange:y}),(0,u.jsxs)("select",{name:"gender",className:"form-input",value:x.gender,onChange:y,children:[(0,u.jsx)("option",{value:"neither",children:"-"}),(0,u.jsx)("option",{value:"male",children:"Male"}),(0,u.jsx)("option",{value:"female",children:"Female"})]})]}),(0,u.jsxs)("div",{className:"form-same-row",children:[(0,u.jsx)("input",{type:"text",name:"age",className:"form-input",placeholder:"Age",value:x.age,onChange:y}),(0,u.jsx)("input",{type:"text",name:"mobile",className:"form-input",placeholder:"Mobile",value:x.mobile,onChange:y})]}),(0,u.jsx)("textarea",{name:"address",className:"form-input",placeholder:"Address",value:x.address,onChange:y,rows:"1"}),(0,u.jsxs)("div",{style:{width:"100%",marginTop:"1.5rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,u.jsx)("label",{htmlFor:"assurance",style:{color:"#112179ff",fontWeight:600,fontSize:"1.05rem"},children:"Assurance Plan"}),(0,u.jsxs)("select",{name:"assurance",value:x.assurance,id:"assurance",onChange:y,style:{padding:"0.8rem 1rem",fontSize:"1rem",borderRadius:"8px",border:"1px solid #ccc",width:"100%",appearance:"none",backgroundColor:"#fff",cursor:"pointer"},children:[(0,u.jsx)("option",{value:"none",children:"None"}),(0,u.jsx)("option",{value:"normal",children:"Normal (50% cover, 180 DH/month)"}),(0,u.jsx)("option",{value:"premium",children:"Premium (100% cover, 365 DH/month)"})]})]}),(0,u.jsxs)("div",{className:"form-same-row",children:[(0,u.jsx)("input",{type:"password",name:"password",className:"form-input",placeholder:"Password",value:x.password,onChange:y}),(0,u.jsx)("input",{type:"password",name:"confpassword",className:"form-input",placeholder:"Confirm Password",value:x.confpassword,onChange:y})]}),(0,u.jsx)("button",{type:"submit",className:"btn form-btn",children:"Update"})]}),(0,u.jsx)("button",{type:"button",className:"btn form-btn",style:{marginTop:"1rem",backgroundColor:"#112179ff"},onClick:()=>f("/"),children:"Back to Home"})]})})}}}]);
//# sourceMappingURL=681.04cca298.chunk.js.map